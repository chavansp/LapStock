<!doctype html>
{% load static %}
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
<meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <title>LapStock</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css"
    integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous" />
  <link rel="stylesheet" href="{% static 'dashboard/css/main.css' %}" />

      <title>Lap-Stock </title>
  </head>

  <body>
  <header>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container-fluid" mr-auto>
          <a class="navbar-brand" href="{% url 'customerhome' %}" style="font-size:20px" >LapStock</a><button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
          <ul class="navbar-nav mr-auto ">

            <li class="nav-item">
              <a class="nav-link active" style="font-size:20px" aria-current="page" href="{% url 'customerhome' %}" >Home</a>
            </li>
&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
         <form class="input-group" style="width: 100%;" method="post" action="{% url 'universalsearch' %}" width="50%">
                {% csrf_token %}
                <input type="text" name="search" class="form-control" placeholder="Search for life's goods....." required>
             &emsp;
                <span class="input-group-btn">
                    <a href="{% url 'universalsearch' %}"><button type='submit' class="btn btn-outline-info" style="background-color: white;" type="button">Search</button></a>
                </span>
            </form>




                 {% if user.is_authenticated %}
&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
              &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
              <ul>
                   <li class="nav-item dropdown mx-2">
                    <a class="nav-link dropdown-toggle text-white" href="#" id="profileDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    {{user.customer.name}} Account
                  </a>


                  <ul class="dropdown-menu" aria-labelledby="profileDropdown">
                <li>
                    <a class="dropdown-item" href="{% url 'showProfile' %}">MyProfile</a></li>
                          <li><a class="dropdown-item" href="{% url 'Customerpasswordchange' %}">Change Password</a></li>
                          <li><a class="dropdown-item" href="{% url 'customerorderlist' %}">Orders </a></li>
                          <li><a class="dropdown-item" href="#"> Whitelists</a></li>
                          <li><a class="dropdown-item" href="{% url 'logout' %}">Sign Out</a></li>

                    </li>
                      </ul>
                   </li>
                 </ul>
                     <ul>
                     <li class="nav-item mx-2">
                          <a href="{% url 'cartview' %}" class="nav-link text-white"></span> Cart </a>
                      </li>
                 </ul>
                {% else %}
&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
               &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;

                   <ul>
                      <li class="nav-item dropdown">
                          <a class="nav-link dropdown-toggle text-white" href="#" id="fashionDropdown" style="font-size:20px" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                              <b>Login</b>
                          </a>
                          <ul class="dropdown-menu" aria-labelledby="fashionDropdown">
                                <a class="dropdown-item" href="{% url 'register' %}">Registration</a>
                                <a class="dropdown-item" href="{% url 'login' %}">Login</a>
                                <a class="dropdown-item" href="{% url 'sellerhome' %}">LapStock_Seller</a>

                          </ul>
                      </li>
                   </ul>
              <ul>
                  <li class="nav-item dropdown">
                          <a class="nav-link dropdown-toggle text-white" href="#" id="profileDropdown"  style="font-size:20px" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                              <b>More</b>
                          </a>
                          <ul class="dropdown-menu" aria-labelledby="profileDropdown">
                              <li><a class="dropdown-item" href="{% url 'sellerlogin' %}">Sell On LapStock</a></li>
                              <li><a class="dropdown-item" href="#">24x7 Customer Care</a></li>
                          </ul>
                      </li>
                      </li>
                  </ul>
                {% endif %}
              </div>

            </li>
          </ul>
        </div>
      </div>
    </nav>
  </header>
  <br /><br />
    {% block content %}
    {% endblock %}

    <!-- Start Footer -->
    <footer class="container-fluid bg-dark text-center p-2 mt-5">
        <small class="text-white">Copyright &copy; 2022 || Designed By B23 || </small>
        <img src="{% static 'app/images/payment.png' %}" alt="" srcset="" class="img-fluid" height="2px">
    </footer> <!-- End Footer -->
    <!-- Jquery -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>

    <script src="{% static 'app/js/owl.carousel.min.js' %}"></script>
    <script src="{% static 'app/js/all.min.js' %}"></script>
    <script src="{% static 'app/js/myscript.js' %}"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script>
            $("#id_country").change(function () {
                const url = $("#profileForm").attr("state_url");  // get the url of the `load_state` view
                const countryId = $(this).val();  // get the selected country ID from the HTML input

                $.ajax({                       // initialize an AJAX request
                    url: url,                    // set the url of the request (= /persons/ajax/load-cities/ )
                    data: {
                        'country_id': countryId       // add the country id to the GET parameters
                    },
                    success: function (data) {   // `data` is the return of the `load_cities` view function
                        $("#id_state").html(data);  // replace the contents of the city input with the data that came from the server
                    }
                });
            });
            $("#id_state").change(function () {
                const url = $("#profileForm").attr("city_url");  // get the url of the `load_state` view
                const stateId = $(this).val();  // get the selected country ID from the HTML input

                $.ajax({                       // initialize an AJAX request
                    url: url,                    // set the url of the request (= /persons/ajax/load-cities/ )
                    data: {
                        'state_id': stateId       // add the country id to the GET parameters
                    },
                    success: function (data) {   // `data` is the return of the `load_cities` view function
                        $("#id_city").html(data);  // replace the contents of the city input with the data that came from the server
                    }
                });

            });
    </script>


    <!-- Ajax for Email OTP verification -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js" type='text/javascript'></script>
    <script>
        var otp_from_back="";
        var email1="";
        function ajax_send_otp(){
           document.getElementById("email_div").style.display='none';
           document.getElementById("send_email_div").style.display='block';
           email = document.getElementById("email");
         $.post("send_otp/",
             {
                 "email":email.value,
                 "csrfmiddlewaretoken":"{{csrf_token}}"
             },
             function(data, status){
                 if(status=="success"){
                     otp_from_back = data;
                     email1=email.value;
                     document.getElementById("send_email_div").style.display='none';
                     document.getElementById("otp_div").style.display='block';
                     }
        }
        );
        }
       function verify_otp(){
           var user_otp=document.getElementById("otp").value;
           if (user_otp==otp_from_back){
               document.getElementById("verify_text_div").style.color="green";
               document.getElementById("verify_text_div").innerHTML="OTP is verified successfully!!";
               document.getElementById("otp_div").style.display="none";
               document.getElementById("form_div").style.display="block";
               $.post("activate/",
                {
                    "email":email1,
                    "csrfmiddlewaretoken":"{{csrf_token}}"
                }
               );
           }
           else{
               document.getElementById("verify_text_div").style.color="red";
               document.getElementById("verify_text_div").innerHTML="You entered wrong OTP please enter correct OTP again!!";
           }
       }
    </script>
    <!-- Ajax for Customer forgot password -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js" type='text/javascript'></script>
    <script>
        var otp_back="";
        var emailpass="";
        function pass_send_otp(){
           document.getElementById("emailpass_div").style.display='none';
           document.getElementById("send_email_pass_div").style.display='block';
           email = document.getElementById("email");
           const url1 = $("#cpassemail").attr("customerpassemail");
         $.post(url1,
             {
                 "email":email.value,
                 "csrfmiddlewaretoken":"{{csrf_token}}"
             },
             function(data, status){
                 if(status=="success"){
                     otp_back = data;
                     emailpass=email.value;
                     console.log(emailpass)
                     document.getElementById("send_email_pass_div").style.display='none';
                     document.getElementById("otp_pass_div").style.display='block';
                     }
        }
        );
        }
       function pass_verify_otp(){
           var user_otp=document.getElementById("otp").value;
           const url2 = $("#verifypassemail").attr("verifypassemail");
           if (user_otp==otp_back){
               document.getElementById("verify_text_pass_div").style.color="green";
               document.getElementById("verify_text_pass_div").innerHTML="OTP is verified successfully!!";
               document.getElementById("otp_pass_div").style.display="none";
               document.getElementById("form_pass_div").style.display="block";
           }
           else{
               document.getElementById("verify_text_pass_div").style.color="red";
               document.getElementById("verify_text_pass_div").innerHTML="You entered wrong OTP please enter correct OTP again!!";
           }
       }


       function change_pass_send(){
            document.getElementById("form_pass_div").style.display='none';
           document.getElementById("success_pass_div").style.display='block';
            var password=document.getElementById("id_new_password1")
            console.log(password.value)
            var c_password=document.getElementById('id_new_password2')
            console.log(c_password.value)
           const url3 = $("#passchange").attr("passchange");

           if(password.value==c_password.value){
         $.post(url3,

             {
                 "email":emailpass,
                 "csrfmiddlewaretoken":"{{csrf_token}}",
                 "new_password2":password.value,

             }
        );
            document.getElementById("verify_text_pass_div").style.color="green";
            document.getElementById("verify_text_pass_div").innerHTML="Password is changed now successfully!!";
            document.getElementById("success_pass_div").style.display='block';
        }
        else{
            document.getElementById("verify_text_pass_div").style.color="red";
            document.getElementById("verify_text_pass_div").innerHTML="Password is not changed, Try again!!";
        }
        }
    </script>

  </body>
</html>
